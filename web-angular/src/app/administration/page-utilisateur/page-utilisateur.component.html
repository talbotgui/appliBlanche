<!-- menu -->
<cadre-menu></cadre-menu>

<!-- Liste des utilisateurs -->
<h3>Liste des utilisateurs</h3>

<!-- Style décrit ici : https://getbootstrap.com/docs/4.0/content/tables/ -->
<table class="table table-striped table-hover">
	<thead>
		<tr>
			<th scope="col">Identifiant</th>
			<th scope="col">Rôles</th>
			<th scope="col">
				<span>Actions</span>
				<em class="actionDansUnEntete fa fa-plus" (click)="creerUtilisateur(); utilisateurForm.reset(utilisateurSelectionne);"></em>
			</th>
		</tr>
	</thead>
	<tbody>
		<tr *ngFor="let utilisateur of utilisateurs" [class.ligneSelectionne]="utilisateur === utilisateurSelectionne">
			<th scope="row">{{utilisateur.login}}</th>
			<td>
				<span *ngFor="let role of utilisateur.roles">{{role.nom}}</span>
			</td>
			<td>
				<em class="fa fa-edit" (click)="selectionnerUtilisateur(utilisateur); utilisateurForm.reset(utilisateur);"></em>
			</td>
		</tr>
	</tbody>
</table>

<!-- Création ou édition d'utilisateur -->
<form novalidate #utilisateurForm="ngForm">
	<div *ngIf="utilisateurSelectionne">

		<!-- Titre -->
		<hr/>
		<h3>Ajouter/modifier un utilisateur</h3>

		<!-- Messages de validation de surface -->
		<div *ngIf="!inputLogin.pristine && inputLogin.errors?.required" class="alert-danger">Le nom d'utilisateur est obligatoire</div>
		<div *ngIf="!inputLogin.pristine && inputLogin.errors?.minlength" class="alert-danger">Le nom d'utilisateur doit faire 6 caractères au minimum</div>
		<div *ngIf="!inputMdp.pristine && inputMdp.errors?.required" class="alert-danger">Le mot de passe est obligatoire</div>
		<div *ngIf="!inputMdp.pristine && inputMdp.errors?.minlength" class="alert-danger">Le mot de passe doit faire 6 caractères au minimum</div>

		<!-- Champs -->
		<input required minlength="6" #inputLogin="ngModel" [(ngModel)]="utilisateurSelectionne.login" name="login" placeholder="Nom d'utilisateur *">
		<input required minlength="6" type="password" #inputMdp="ngModel" [(ngModel)]="utilisateurSelectionne.mdp" name="mdp" placeholder="Mot de passe *">

		<!-- Boutons -->
		<button type="submit" class="btn btn-outline-secondary" (click)="annulerCreationUtilisateur()">Annuler</button>
		<button type="submit" class="btn btn-outline-secondary" [disabled]="!utilisateurForm.form.valid" (click)="sauvegarderUtilisateur()">Sauvegarder</button>
	</div>
</form>